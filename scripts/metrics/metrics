#!/bin/bash
# Metrics Launcher - Convenient access to all metrics scripts

set -euo pipefail

# Colors
BLUE='\033[0;34m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Show help
show_help() {
    echo -e "${BLUE}GitHub Metrics Tracking System${NC}"
    echo
    echo "Usage: metrics [command] [options]"
    echo
    echo "Commands:"
    echo "  today           Show today's metrics"
    echo "  yesterday       Show yesterday's metrics"
    echo "  thisweek        Show this week's summary"
    echo "  lastweek        Show last week's summary"
    echo "  month           Show last 30 days metrics"
    echo "  features        Track feature development"
    echo "  tests           Analyze test coverage"
    echo "  full [start] [end]  Full report for date range"
    echo
    echo "Examples:"
    echo "  metrics today"
    echo "  metrics thisweek"
    echo "  metrics full 2024-01-01 2024-01-31"
    echo
    echo "All reports are saved in: ${SCRIPT_DIR}/reports/"
}

# Main logic
case "${1:-help}" in
    today)
        "${SCRIPT_DIR}/daily-metrics.sh"
        ;;
    yesterday)
        yesterday=$(date -v-1d +%Y-%m-%d 2>/dev/null || date -d 'yesterday' +%Y-%m-%d)
        "${SCRIPT_DIR}/daily-metrics.sh" "$yesterday"
        ;;
    thisweek)
        "${SCRIPT_DIR}/weekly-summary.sh" thisweek
        ;;
    lastweek)
        "${SCRIPT_DIR}/weekly-summary.sh" lastweek
        ;;
    month)
        "${SCRIPT_DIR}/github-metrics.sh"
        ;;
    features)
        shift
        "${SCRIPT_DIR}/feature-tracker.sh" "$@"
        ;;
    tests)
        shift
        "${SCRIPT_DIR}/test-coverage-tracker.sh" "$@"
        ;;
    full)
        shift
        "${SCRIPT_DIR}/github-metrics.sh" "$@"
        ;;
    help|--help|-h)
        show_help
        ;;
    *)
        echo -e "${YELLOW}Unknown command: $1${NC}"
        echo
        show_help
        exit 1
        ;;
esac