# Release v0.9.0 - CycleBuilder API Migration

**Date**: 2025-01-27
**Version**: 0.9.0
**Type**: Minor Release

## üéâ Overview
This release completes the comprehensive migration from the deprecated `cycle=True` pattern to the modern CycleBuilder API across the entire Kailash SDK codebase. This modernization improves code clarity, maintainability, and provides a more intuitive API for creating cyclic workflows.

## üöÄ Key Highlights
- Complete migration from `cycle=True` to CycleBuilder API
- Updated all documentation and examples (148 files)
- Maintained full backward compatibility
- Enhanced cyclic workflow patterns for enterprise use

## üìä By The Numbers
- Files updated: 148
- Documentation files fixed: 119+
- SDK examples migrated: 8
- Performance tests updated: 7
- Test coverage: 100% (3,614 unit tests passing)

## üîß Technical Details

### CycleBuilder API Patterns

The new API provides two patterns based on the workflow class:

#### WorkflowBuilder (Build-First Pattern)
```python
from kailash.workflow.builder import WorkflowBuilder
from kailash.runtime.local import LocalRuntime

workflow = WorkflowBuilder()
workflow.add_node("DataProcessorNode", "processor", {"threshold": 0.9})
workflow.add_node("QualityEvaluatorNode", "evaluator", {"target_quality": 0.95})

# Build first, then create cycle
built_workflow = workflow.build()
cycle = built_workflow.create_cycle("quality_improvement")
cycle.connect("processor", "evaluator", mapping={"result": "input_data"}) \
     .connect("evaluator", "processor", mapping={"feedback": "adjustment"}) \
     .max_iterations(50) \
     .converge_when("quality > 0.95") \
     .build()

runtime = LocalRuntime()
results, run_id = runtime.execute(built_workflow)
```

#### Workflow (Direct Chaining Pattern)
```python
from kailash.workflow.graph import Workflow
from kailash.runtime.local import LocalRuntime

workflow = Workflow(workflow_id="demo", name="Demo")
workflow.add_node("processor", ProcessorNode())
workflow.add_node("evaluator", EvaluatorNode())

# Direct chaining - no build() first
workflow.create_cycle("quality_improvement") \
        .connect("processor", "evaluator", mapping={"result": "input_data"}) \
        .connect("evaluator", "processor", mapping={"feedback": "adjustment"}) \
        .max_iterations(50) \
        .converge_when("quality > 0.95") \
        .build()

runtime = LocalRuntime()
results, run_id = runtime.execute(workflow)
```

### Special Patterns

#### SwitchNode with Cycles
```python
# Setup forward connections first
workflow.connect("switch", "optimizer", condition="false_output", mapping={...})
workflow.connect("switch", "final", condition="true_output", mapping={...})

# Then create cycle (no conditions in cycle)
workflow.create_cycle("optimization_cycle") \
        .connect("optimizer", "packager", mapping={...}) \
        .connect("packager", "switch", mapping={...}) \
        .max_iterations(10) \
        .converge_when("converged == True") \
        .build()
```

## üî¥ Breaking Changes
None - the old `cycle=True` pattern remains supported for backward compatibility. However, all new code should use the CycleBuilder API.

## üîÑ Migration Guide

### From Old Pattern
```python
workflow.connect("processor", "processor",
                 cycle=True,
                 max_iterations=10,
                 convergence_check="score > 0.95")
```

### To New Pattern
```python
# For WorkflowBuilder
built_workflow = workflow.build()
built_workflow.create_cycle("cycle_name") \
              .connect("processor", "processor") \
              .max_iterations(10) \
              .converge_when("score > 0.95") \
              .build()

# For Workflow
workflow.create_cycle("cycle_name") \
        .connect("processor", "processor") \
        .max_iterations(10) \
        .converge_when("score > 0.95") \
        .build()
```

## üìö Documentation
- [Cyclic Workflow Guide](sdk-users/3-development/31-cyclic-workflows-guide.md)
- [Working Examples](sdk-users/2-core-concepts/workflows/by-pattern/cyclic/)
- [Migration Patterns](sdk-users/CLAUDE.md#cyclic-workflows---two-class-patterns)

## üìã Complete Changelog

### Added
- CycleBuilder API implementation across all workflow classes
- Comprehensive test suite for cyclic workflow validation
- New examples demonstrating enterprise cyclic patterns
- Enhanced documentation for both workflow class patterns

### Changed
- Updated all documentation from `cycle=True` to CycleBuilder API
- Migrated all SDK examples to use modern patterns
- Updated performance benchmarks to use CycleBuilder
- Improved error messages for cycle configuration
- Enhanced CLAUDE.md with clear pattern guidance

### Fixed
- Fixed SwitchNode conditional routing in cyclic workflows
- Corrected parameter mapping in cyclic demonstrations
- Fixed convergence threshold in optimization examples
- Resolved import issues in conditional routing patterns
- Fixed test isolation issues in cyclic workflow tests

### Deprecated
- `cycle=True` parameter in workflow connections (still supported for compatibility)
- Old convergence_check parameter name (use converge_when)

### Security
- No security changes in this release

## üôè Acknowledgments
This comprehensive migration ensures the Kailash SDK follows modern best practices while maintaining full backward compatibility for existing workflows.
